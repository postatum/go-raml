{{- define "client_service" -}}
# DO NOT EDIT THIS FILE. This file will be overwritten when re-running go-raml.

{{- range $k, $v := .Imports}}
{{ $v }}
{{- end}}
{{ $UnmarshallResponse := .UnmarshallResponse}}

class {{.Name}}:
    def __init__(self, client):
        self.client = client

{{ range $k, $v := .Methods }}
    def {{$v.MethodName}}({{$v.Params}}):
        """{{ range $kf, $vf := $v.FuncComments }}
        {{$vf}}{{end}}
        It is method for {{$v.Verb}} {{$v.Endpoint}}
        """
        if query_params is None:
            query_params = {}
        {{ range $k, $v := $v.QueryParameters}}
        query_params['{{$k}}'] = {{$k}}{{ end }}

        uri = self.client.base_url {{$v.Route}}
        {{- if (and $v.HasRespBody $UnmarshallResponse ) }}
        resp = {{$v.PRCall}}({{$v.PRArgs}})
        try:
        {{- range $k, $rbt := $v.SuccessRespBodyTypes }}
            if resp.status_code == {{$rbt.Code}}:
            {{- if $rbt.IsArray}}
                resps = []
                for elem in resp.json():
                    resps.append({{$rbt.BasicType}}(elem))
                return resps, resp
            {{- else}}
                return {{$rbt.BasicType}}(resp.json()), resp
            {{- end}}
		{{- end }}

            message = 'unknown status code={}'.format(resp.status_code)
            raise UnhandledAPIError(response=resp, code=resp.status_code,
                                    message=message)
        except ValueError as msg:
            raise UnmarshallError(resp, msg)
        except UnhandledAPIError as uae:
            raise uae
        except Exception as e:
            raise UnmarshallError(resp, e.message)
        {{- else }}
        return {{$v.PRCall}}({{$v.PRArgs}})
        {{- end}}
{{ end -}}
{{- end -}}
